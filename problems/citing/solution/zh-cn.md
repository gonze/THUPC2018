{{ self.title() }}

n+e

## 题目简述

给定一个 $N\times M$ 的01矩阵 $A$，以及一个大小小于 $A$ 的01模板矩阵 $B$，要求在匹配的时候，$B$ 中的1不能覆盖到 $A$ 中的1上，求成功匹配的方案数。

## 算法1：暴力

假设 $B$ 的大小为 $R\times C$，每次暴力匹配的复杂度即为 $O(RC)$， 共需匹配 $O((N-R)(M-C))$ 次，总复杂度为 $O(R(N-R)C(M-C))$。

由于均值不等式，$(a+b)^2\ge 2ab$，变形可得 $ab\le \frac{(a+b)^2}{2}$，因此 $R(N-R)C(M-C)\le \frac{N^2M^2}{4}$，总复杂度可认为是 $O(N^2M^2)$，并且在 $R=\frac{N}{2}$，$C=\frac{M}{2}$ 的时候达到极限运算数。事实上本题的极限数据就是符合这个设定。

## 算法2：优秀的暴力

由于匹配不成功，当且仅当 $A$ 中的1和 $B$ 中的1重合，因此只需要for这些1即可，而不必for一堆0。这么做能比普通的暴力快不少，但是由于出题人精心构造的数据还是无法通过。

## 算法3：压位

应该不用多讲了吧，假设压 $w$ 位，则复杂度为 $O(\frac{N^2M^2}{w})$，取 $w=64$ 即可轻松通过。